<main class="node-express">
    <h2 class="intro">
        Node JS
    </h2>
    <p class="welcome">
        As we said before, node-js is a runtime environment that helps us to run javascript in our local machines.
        It also helps us to use libraries and/or frameworks to build our web server applications. In this tutorial
        we will be using <span class="express">Express</span> to achieve that.
    </p>
    <h3 id="express">
        Express JS
    </h3>
    <p class="mandate">
        Express is one of Node frameworks that is easy to understand and helps us to get the task as quickly as possible.
        It is known to be Fast, unopinionated, minimalist web framework for Node.js. Understanding Express
        will help you to develop your API in order to communicate with your database (MongoDB) and use your API
        to connect with your frontend (In this case with your <a routerLink="/angular" class="angular">Angular</a> application)
    </p>
    <article class="main-content">
        <p class="heading">
            Getting started
        </p>
        <div class="body">
            <p class="body-intro">
                In order to start you need to have your Node Js installed.
            </p>
            <div class="code-block">
                <code>
                    <span class="comment">
                        // to check if installed - check the version
                    </span>
                    $ node --version
                    <span class="comment">
                        // to install latest version - if not installed yet
                        <br>
                        <a href="https://nodejs.org/en/download/" class="download-node" target="_blank">https://nodejs.org/en/download/</a>
                    </span>
                </code>
            </div>
            <p>
                Once Node is installed then you ready to develop your api. Create a folder, then create a .js file i.e. (server.js ...).
                Then on your terminal run the command below to initialise Node Package Modules, this will generate a file called <span class="fw-bold">package.json</span> that has key information about the api you are developing.
            </p>
            <div class="code-block">
                <code>
                    <span class="comment">
                        // initialising npm - default (yes)
                    </span>
                    $ npm init --yes
                </code>
            </div>
            <div class="image"></div>
            <p>
                Then on your terminal in the same diractory start installing all the dependecies that you will need such as express and many more.
            </p>
            <div class="code-block">
                <code>
                    <span class="comment">
                        // installing dependencies
                    </span>
                    $ npm install express mongoose cors --save
                </code>
            </div>
            <div class="cointainer">
                <p>
                    After you ran these commands you should see such results below. In this tutorial <span class="fw-bold">api</span> folder is a root folder. Inside of this folder you have <span class="fw-bold">node_modules</span> (these are the libraries from node), <span class="fw-bold">package.json</span> (file created when you installed express) and <span class="fw-bold">server.js</span> (file you created at the beginning).
                </p>
                    <img src="https://i.postimg.cc/tTy568yn/installed-express.png" alt="" class="instal-express mb-2">
                <p>
                    We will be using <span class="fw-bold">express</span> to develop our <span class="fw-bold">api</span>, using <span class="fw-bold">mongoose</span> to form connection with <span class="fw-bold">MongoDB</span> and <span class="fw-bold">cors</span> to allow communication with our api and the angular server to communicate.
                </p>
                <h4 class="folder-stru fw-bold">
                    Folder Structure
                </h4>
                <p>
                    The folder structure of this backend will be as following:
                </p>
                <div class="f-image">
                    <img src="https://i.postimg.cc/QtKpYKG5/Screenshot-2023-01-09-at-11-27-10.png" alt="" class="folder">
                    <p>In the above email, you see <strong>app</strong> diractory where inside the directory there's <strong>config</strong> folder (to config your database), your <strong>controller</strong> folder (to write logic or fuctions that communicate with your database), <strong>models</strong> folder (to create your schema that maps your data in your database), lastly <strong>routes</strong> folder (to create dynamic routing towards a specific path while performing CRUD). </p>
                </div>
                <p>
                    On server.js add the code below to create your basic structure of your server, and go to your terminal to run
                    <strong>node server.js</strong>
                </p>
                <div class="code-block">
                    <code>
                        <span class="comment">
                            // server.js
                        </span>
                        <div class="line">
                            <span class="var">const</span>
                            <span class="variable"> express </span>
                            <span class="equi">=</span>
                            <span class="variable"> require</span>
                            <span class="braces">(</span>
                            <span class="lib">'express'</span>
                            <span class="braces">)</span>
                        </div>
                        <div class="line">
                            <span class="var">const</span>
                            <span class="variable"> cors </span>
                            <span class="equi">=</span>
                            <span class="variable"> require</span>
                            <span class="braces">(</span>
                            <span class="lib">'cors'</span>
                            <span class="braces">)</span>
                        </div>
                        <br>
                        <div class="line">
                            <span class="var">const</span>
                            <span class="variable"> app </span>
                            <span class="equi">=</span>
                            <span class="variable"> express</span>
                            <span class="braces">()</span>
                        </div>
                        <br>
                        <div class="line">
                            <span class="var">let</span>
                            <span class="variable"> corsOptions </span>
                            <span class="equi">=</span>
                            <span class="braces"> {{ '{' }}</span>
                            <br>
                            <span class="variable ps-4">origin:</span>
                            <span class="lib">'http://localhost:8081';</span>
                            <br>
                            <span class="braces ps-2">{{ '}' }}</span>
                        </div>
                        <br>
                        <div class="line">
                            <span class="var">app.</span>
                            <span class="variable">use</span>
                            <span class="braces">(</span>
                            <span class="variable">cors</span>
                            <span class="braces-1">(</span>
                            <span class="var">corsOptions</span>
                            <span class="braces-1">)</span>
                            <span class="braces">)</span>
                        </div>
                        <div class="line">
                            <span class="var">app.</span>
                            <span class="variable">use</span>
                            <span class="braces">(</span>
                            <span class="variable">express</span>
                            <span class="var">.</span>
                            <span class="variable">json</span>
                            <span class="braces-1">(</span>
                            <span class="braces-1">)</span>
                            <span class="braces">)</span>
                        </div>
                        <div class="line">
                            <span class="var">app.</span>
                            <span class="variable">use</span>
                            <span class="braces">(</span>
                            <span class="variable">express</span>
                            <span class="var">.</span>
                            <span class="variable">urlencoded</span>
                            <span class="braces-1">(</span>
                            <span class="braces-2">{{ '{' }}</span>
                            <span class="var"> extended:</span>
                            <span class="braces-1"> true </span>
                            <span class="braces-2">{{ '}' }}</span>
                            <span class="braces-1">)</span>
                            <span class="braces">)</span>
                        </div>
                        <br>
                        <div class="line">
                            <span class="var">app.</span>
                            <span class="variable">set</span>
                            <span class="braces">(</span>
                            <span class="lib">'port'</span>
                            <span class="var">, process.env.PORT</span>
                            <span class="equi"> ||</span>
                            <span class="braces-1"> 8080</span>
                            <span class="braces">)</span>
                        </div>
                        <br>
                        <div class="line">
                            <span class="var">app.</span>
                            <span class="variable">get</span>
                            <span class="braces">(</span>
                            <span class="lib">'/'</span>
                            <span class="var">, </span>
                            <span class="braces-1">(</span>
                            <span class="param">req</span>
                            <span class="var">, </span>
                            <span class="param">res</span>
                            <span class="var">, </span>
                            <span class="variable">next</span>
                            <span class="braces-1">)</span>
                            <span class="var"> => </span>
                            <span class="braces-1">{{ '{' }} </span>
                            <br>
                            <span class="param ps-4">res</span>
                            <span class="var">.</span>
                            <span class="variable">send</span>
                            <span class="braces-2">(</span>
                            <span class="lib">"{{'<'}}h1{{'>'}}Hello world{{'<'}}{{'/'}}h1{{'>'}}"</span>
                            <span class="braces-2">)</span>
                            <br>
                            <span class="braces-1 ps-2">}</span>
                            <span class="braces">)</span>
                        </div>
                        <div class="line">
                            <span class="var">app.</span>
                            <span class="variable">listen</span>
                            <span class="braces">(</span>
                            <span class="var">app.</span>
                            <span class="variable">get</span>
                            <span class="braces">(</span>
                            <span class="lib">'port'</span>
                            <span class="var">, </span>
                            <span class="braces-1">()</span>
                            <span class="var"> => </span>
                            <span class="braces-1">{{ '{' }} </span>
                            <br>
                            <span class="param ps-4">console</span>
                            <span class="var">.</span>
                            <span class="variable">info</span>
                            <span class="braces-2">(</span>
                            <span class="lib">"{{'<'}}h1{{'>'}}Hello world{{'<'}}{{'/'}}h1{{'>'}}"</span>
                            <span class="braces-2">)</span>
                            <br>
                            <span class="braces-1 ps-2">}</span>
                            <span class="braces">)</span>
                        </div>
                    </code>
                </div>
                <h4 class="fw-bold">
                    Configure Your MongoDB Database
                </h4>
                <div class="code-block py-2">
                    <code>
                        <span class="comment">
                            // diractory -> app/config/db.config.js
                            <br>
                            // db.config.js
                        </span>
                        <div class="line">
                            <span class="var">module.</span>
                            <span>exports</span>
                            <span class="var"> = </span>
                            <span class="braces">{{ '{' }}</span>
                            <br>
                            <span class="variable ps-4">url</span>
                            <span class="var">:</span>
                            <span>'mongodb://localhost:27017/users_db'</span>
                            <br>
                            <span class="braces ps-2">{{ '}' }}</span>
                        </div>
                    </code>
                </div>
                <h4 class="fw-bold">
                  Define your Database Data
                </h4>
                <p class="content-db">
                  Before you could start storing your data on your database, you need to draw your database. To draw your database
                  simply means you need to define your <span class="fw-bold">schema</span> <em> (structure of your data)</em>.
                  This schema will help the database to understand the structure of your data every time you storing it.
                </p>
                <div class="code-block py-2">
                  <code>
                      <span class="comment">
                          // directory -> <strong>app/models/user.model.js</strong>
                          <br>
                          <!-- // db.config.js -->
                      </span>
                      <div class="line">
                          <span class="var">module.</span>
                          <span>exports</span>
                          <span class="var"> = </span>
                          <span class="var">mongoose</span>
                          <span class="var"> =></span>
                          <span class="braces ps-2">{{ '{' }}</span>
                          <br>
                          <span class="declare ps-2">const</span>
                          <span class="var"> schema</span>
                          <span> =</span>
                          <span class="var"> mongoose.</span>
                          <span>Schema</span>
                          <span class="braces-1">(</span>
                          <div class="group ps-4">
                            <span class="braces-2">{{ '{' }}</span>
                            <br>
                            <div class="group ps-2">
                              <span class="var">name: </span>
                              <span>String</span>
                              <span class="var">,</span>
                              <br>
                              <span class="var">surname: </span>
                              <span>String</span>
                              <span class="var">,</span>
                              <br>
                              <span class="var">age: </span>
                              <span>Number</span>
                              <span class="var">,</span>
                              <br>
                              <span class="var">about: </span>
                              <span>String</span>
                              <span class="var">,</span>
                              <br>
                              <span class="var">interest: </span>
                              <span>String</span>
                              <span class="var">,</span>
                              <br>
                              <span class="var">strength: </span>
                              <span>String</span>
                              <span class="var">,</span>
                            </div>
                            <span class="braces-2">{{ '}'}}</span>
                            <span class="var">,</span>
                            <br>
                            <span class="braces-2">{{'{ '}}</span>
                            <span class="var">timestamp:</span>
                            <span> true</span>
                            <span class="braces-2">{{' }'}}</span>
                          </div>
                          <span class="braces ps-2">);</span>
                          <br>

                          <br>
                          <span class="comment">
                            // destraacturing the schema, changing _id to id

                          </span>
                          <span class="ps-2 var">schema.</span>
                          <span>method</span>
                          <span class="braces">(</span>
                          <span class="str">"toJSON",</span>
                          <span class="declare">function</span>
                          <span class="braces">() {{ ' {'}}</span>
                          <div class="group ps-4">
                            <span class="declare">const </span>
                            <span class="braces">{{'{'}}</span>
                            <span class="var"> __v, _id, ...object </span>
                            <span class="braces">{{'}'}}</span>
                            <span class="equi"> = </span>
                            <span class="declare">this</span>
                            <span class="var">.</span>
                            <span>toObject</span>
                            <span class="braces">()</span>
                            <br>
                            <span class="var">object.id</span>
                            <span class="equi"> = </span>
                            <span class="var">id;</span>
                            <br>
                            <span class="declare">return</span>
                            <span class="var"> object;</span>
                          </div>
                          <span class="braces ps-2">{{'}'}});</span>
                          <div class="group ps-2 mt-2">
                            <span class="declare">const</span>
                            <span class="var"> User</span>
                            <span class="equi"> = </span>
                            <span class="var">mongoose.</span>
                            <span>model</span>
                            <span class="braces">(</span>
                            <span class="str">"users"</span>
                            <span class="var">, schema</span>
                            <span class="braces">);</span>
                            <br>
                            <span class="declare">return</span>
                            <span class="var"> User</span>
                          </div>

                          <span class="braces">{{'}'}};</span>
                      </div>
                  </code>
              </div>
              <h4 class="fw-bold">Create Controller</h4>
              <p class="content-crl">
                Your CRUD functionality is developed in the controllers. This helps us to separate our work.
              </p>

              <p class="crl-1">
                Inside the app/controller folder we will start our crud.
              </p>
              <ul class="functions">
                <li class="function">create</li>
                <li class="function">findAll</li>
                <li class="function">findOne</li>
                <li class="function">updateOne</li>
                <li class="function">deleteOne</li>
              </ul>
              <p class="building">
                in order to create these functions we will need to import the models folder
                 that has <strong>mongoose models</strong> that supports all the functions we will need.
              </p>
              <p class="fw-bold">CREATING A USER</p>
              <div class="code-block py-2">
                <code>
                    <span class="comment">
                        // directory -> <strong>app/controllers/user.controller.js</strong>
                    </span>
                    <div class="line">
                        <span class="declare">const </span>
                        <span class="var">db</span>
                        <span class="equi"> = </span>
                        <span class="variable">require</span>
                        <span class="braces">(</span>
                        <span class="str">"../models"</span>
                        <span class="braces">)</span>
                        <br>
                        <span class="declare">const </span>
                        <span class="var">User</span>
                        <span class="equi"> = </span>
                        <span class="var">db.user</span>
                        <br>
                    </div>
                    <!-- CREATING A USER -->
                    <div class="line">
                        <div class="function-1 mt-3">
                            <span class="var">exports.</span>
                            <span class="variable">create</span>
                            <span class="equi"> = </span>
                            <span class="braces">(</span>
                            <span class="param">req</span>
                            <span class="braces">, </span>
                            <span class="param">res</span>
                            <span class="braces">)</span>
                            <span class="equi"> => </span>
                            <span class="braces">{{'{'}}</span>
                            <br>
                            <div class="ps-2">
                                <span class="comment">
                                    // VALIDATING REQUEST
                                </span>
                                <span>if</span>
                                <span class="braces-1">(</span>
                                <span>!</span>
                                <span class="param">req</span>
                                <span class="var">.body.name</span>
                                <span class="braces-1">) </span>
                                <span class="braces-1">{{'{'}}</span>
                                <br>
                                <div class="ps-2">
                                    <span class="param">req</span>
                                    <span class="var">.</span>
                                    <span class="variable">status</span>
                                    <span class="braces-2">(</span>
                                    <span class="braces-1">400</span>
                                    <span class="braces-2">)</span>
                                    <span class="var">.</span>
                                    <span class="variable">send</span>
                                    <span class="braces-2">(</span>
                                    <span class="braces">{{'{'}}</span>
                                    <span class="var"> message:</span>
                                    <span class="str"> "The name cannot be empty!" </span>
                                    <span class="braces">{{'}'}}</span>
                                    <span class="braces-2">)</span>
                                </div>
                                <span class="braces-1">{{'}'}}</span>
                                <br><br>
                                <span class="comment">
                                    // CREATING A NEW USER
                                </span>
                                <span class="declare">const </span>
                                <span class="var">user</span>
                                <span class="equi"> = </span>
                                <span>new </span>
                                <span class="var">User</span>
                                <span class="braces-1">(</span>
                                <span class="param">req</span>
                                <span class="var">.body</span>
                                <span class="braces-1">)</span>
                                <br><br>
                                <span class="comment">
                                    // SAVING USER TO THE DATABASE
                                </span>
                                <span class="var">user.</span>
                                <span class="variable">save</span>
                                <span class="braces-1">(</span>
                                <span class="var">user</span>
                                <span class="braces-1">)</span>
                                <span class="var">.</span>
                                <span class="variable">then</span>
                                <span class="braces-1">(</span>
                                <span class="param">data</span>
                                <span class="equi"> =></span>
                                <span class="braces-2"> {{'{'}}</span>
                                <br>
                                <div class="ps-4">
                                  <span class="param">res</span>
                                  <span class="var">.</span>
                                  <span class="variable">status</span>
                                  <span class="braces">(</span>
                                  <span class="braces-1">200</span>
                                  <span class="braces">)</span>
                                  <span class="var">.</span>
                                  <span class="variable">send</span>
                                  <span class="braces">(</span>
                                  <span class="param">data</span>
                                  <span class="braces">)</span>
                                </div>
                                <span class="braces-2">{{'}'}}</span>
                                <span class="braces-1">)</span>
                                <span class="var">.</span>
                                <span class="variable">catch</span>
                                <span class="braces-1">(</span>
                                <span class="param">err</span>
                                <span class="equi"> =></span>
                                <span class="braces-2"> {{'{'}}</span>
                                <div class="ps4">
                                    <span class="param">res</span>
                                    <span class="var">.</span>
                                    <span class="variable">status</span>
                                    <span class="braces">(</span>
                                    <span class="braces-1">400</span>
                                    <span class="braces">)</span>
                                    <span class="var">.</span>
                                    <span class="variable">send</span>
                                    <span class="braces">(</span>
                                    <span class="braces-1">{{'{'}}</span>
                                    <span class="var"> message: </span>
                                    <span class="param">err</span>
                                    <span class="var">.message </span>
                                    <span class="braces-1">{{'}'}}</span>
                                    <span class="braces">)</span>
                                </div>
                            </div>
                            <br>
                            <span class="braces">{{'}'}}</span>
                        </div>
                    </div>
                </code>
              </div>
              <p class="summary">Summary of what is happening the code snippet above:</p>
              <ul>
                <small><li>It first checks if the "name" field is present in the request body. If not, it returns a "400 Bad Request" error with a message "The name cannot be empty!"</li>
                <li>It then creates a new User object using the request body and saves it to the database using the save() method</li>
                <li>If the saving is successful, it returns a "201 Created" response with the saved data</li>
                <li>If an error occurs during saving, it returns a "500 Internal Server Error" with the error message</li></small>
              </ul>
              <p class="fw-bold">GET ALL THE USERS</p>
              <div class="code-block py-2">
                <code>
                    <div class="line">
                        <!-- FINDING ALL THE USERS -->
                        <div class="function-1 mt-3">
                            <span class="var">exports.</span>
                            <span class="variable">findAll</span>
                            <span class="equi"> = </span>
                            <span class="braces">(</span>
                            <span class="param">req</span>
                            <span class="braces">, </span>
                            <span class="param">res</span>
                            <span class="braces">)</span>
                            <span class="equi"> => </span>
                            <span class="braces">{{'{'}}</span>
                            <br>
                            <div class="ps-2">
                                <span>if</span>
                                <span class="braces-1">(</span>
                                <span>!</span>
                                <span class="param">req</span>
                                <span class="var">.body.name</span>
                                <span class="braces-1">) </span>
                                <span class="braces-1">{{'{'}}</span>
                                <br>
                                <div class="ps-2">
                                    <span class="param">req</span>
                                    <span class="var">.</span>
                                    <span class="variable">status</span>
                                    <span class="braces-2">(</span>
                                    <span class="braces-1">400</span>
                                    <span class="braces-2">)</span>
                                    <span class="var">.</span>
                                    <span class="variable">send</span>
                                    <span class="braces-2">(</span>
                                    <span class="braces">{{'{'}}</span>
                                    <span class="var"> message:</span>
                                    <span class="str"> "The name cannot be empty!" </span>
                                    <span class="braces">{{'}'}}</span>
                                    <span class="braces-2">)</span>
                                </div>
                                <span class="braces-1">{{'}'}}</span>
                                <br><br>
                                <span class="declare">const </span>
                                <span class="var">user</span>
                                <span class="equi"> = </span>
                                <span>new </span>
                                <span class="var">User</span>
                                <span class="braces-1">(</span>
                                <span class="param">req</span>
                                <span class="var">.body</span>
                                <span class="braces-1">)</span>
                                <br><br>
                                <span class="var">user.</span>
                                <span class="variable">save</span>
                                <span class="braces-1">(</span>
                                <span class="var">user</span>
                                <span class="braces-1">)</span>
                                <span class="var">.</span>
                                <span class="variable">then</span>
                                <span class="braces-1">(</span>
                                <span class="param">data</span>
                                <span class="equi"> =></span>
                                <span class="braces-2"> {{'{'}}</span>
                                <br>
                                <div class="ps-4">
                                  <span class="param">res</span>
                                  <span class="var">.</span>
                                  <span class="variable">status</span>
                                  <span class="braces">(</span>
                                  <span class="braces-1">200</span>
                                  <span class="braces">)</span>
                                  <span class="var">.</span>
                                  <span class="variable">send</span>
                                  <span class="braces">(</span>
                                  <span class="param">data</span>
                                  <span class="braces">)</span>
                                </div>
                                <span class="braces-2">{{'}'}}</span>
                                <span class="braces-1">)</span>
                                <span class="var">.</span>
                                <span class="variable">catch</span>
                                <span class="braces-1">(</span>
                                <span class="param">err</span>
                                <span class="equi"> =></span>
                                <span class="braces-2"> {{'{'}}</span>
                                <div class="ps4">
                                    <span class="param">res</span>
                                    <span class="var">.</span>
                                    <span class="variable">status</span>
                                    <span class="braces">(</span>
                                    <span class="braces-1">400</span>
                                    <span class="braces">)</span>
                                    <span class="var">.</span>
                                    <span class="variable">send</span>
                                    <span class="braces">(</span>
                                    <span class="braces-1">{{'{'}}</span>
                                    <span class="var"> message: </span>
                                    <span class="param">err</span>
                                    <span class="var">.message </span>
                                    <span class="braces-1">{{'}'}}</span>
                                    <span class="braces">)</span>
                                </div>
                            </div>
                            <br>
                            <span class="braces">{{'}'}}</span>
                        </div>
                    </div>
                </code>
              </div>
            </div>
        </div>
    </article>

</main>
